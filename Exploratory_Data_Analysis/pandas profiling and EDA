{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"pandas profiling and EDA","provenance":[{"file_id":"12PRKu7R0YM8Ub6bWwHjo451kFCQ3eom-","timestamp":1636050547759}],"collapsed_sections":[],"authorship_tag":"ABX9TyPDZuyp4Vn2oxcVhQNduUQf"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"c117f22fc4a74d2da8f69e4427ca991a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b88142ed89c642dca561363da6407560","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_40d1ea0dcc2d4e24ab5411345c96ae38","IPY_MODEL_76d21ec86d49400697c2d0cd1459d008","IPY_MODEL_b83ff9c008204e649ff415ffce720fee"]}},"b88142ed89c642dca561363da6407560":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"40d1ea0dcc2d4e24ab5411345c96ae38":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_197d00ef2be64a9faed0d5a3f538fdb4","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Summarize dataset: ","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5395459aa24f4838b88c31113ae55b60"}},"76d21ec86d49400697c2d0cd1459d008":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_58a78a250b8e49d48ffb766b4017d31b","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":32,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":32,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_821416ec241049be8edb1eac5cda6b58"}},"b83ff9c008204e649ff415ffce720fee":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_406715bb620d4b2194509ebae05dcfdc","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 34/? [00:44&lt;00:00,  2.92s/it, Completed]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2b5dbff509104103ac711fc6a45d21ad"}},"197d00ef2be64a9faed0d5a3f538fdb4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5395459aa24f4838b88c31113ae55b60":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"58a78a250b8e49d48ffb766b4017d31b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"821416ec241049be8edb1eac5cda6b58":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"406715bb620d4b2194509ebae05dcfdc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"2b5dbff509104103ac711fc6a45d21ad":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2238daf7f65d4863956a904a8972bb33":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d6fd430977a9409fa484bb3b3396137a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_90c1e106b28445a381eaa15d9560d1c3","IPY_MODEL_a3cb496a5d7b4e9f8b96ae792af435c4","IPY_MODEL_1fa06be1b18d45a99c43503e459bfffd"]}},"d6fd430977a9409fa484bb3b3396137a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"90c1e106b28445a381eaa15d9560d1c3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a41cb4c70df34c868ac89f3b99f38d33","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Generate report structure: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1d9ea359d97d4336be271d7b3b92436b"}},"a3cb496a5d7b4e9f8b96ae792af435c4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7829b95388f24fab8ef58eb9f997bf28","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7148fa349cc6404f85a8157e49a8a283"}},"1fa06be1b18d45a99c43503e459bfffd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a97bac14e70842e2b70a7b8ebe70ab32","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:08&lt;00:00,  8.13s/it]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cd83874c7bda401c8002bbd277f9bc50"}},"a41cb4c70df34c868ac89f3b99f38d33":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1d9ea359d97d4336be271d7b3b92436b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7829b95388f24fab8ef58eb9f997bf28":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7148fa349cc6404f85a8157e49a8a283":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a97bac14e70842e2b70a7b8ebe70ab32":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"cd83874c7bda401c8002bbd277f9bc50":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"21146f330bd5453e97abd4876167e33f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5abb01e97268445b898b7e54e6d80a78","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_819a3b9994fc4590b8a03c67ec4a35b6","IPY_MODEL_d50b197d173043b3b41533e400de710b","IPY_MODEL_58a4f5194a8a4a6794f78c96f738885c"]}},"5abb01e97268445b898b7e54e6d80a78":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"819a3b9994fc4590b8a03c67ec4a35b6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0b5e406f041d4522ad1954ae6999b295","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Render HTML: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_736b1a078c7240ffa3119daae48ff73c"}},"d50b197d173043b3b41533e400de710b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0b272075f35e46179452ae5a3e864d41","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5a9595a2de7247108a2ed76085d0e903"}},"58a4f5194a8a4a6794f78c96f738885c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e08bb36a3afa4b9090f025e31b030dca","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:08&lt;00:00,  8.51s/it]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c393372b953d469ab58a75dac544c294"}},"0b5e406f041d4522ad1954ae6999b295":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"736b1a078c7240ffa3119daae48ff73c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0b272075f35e46179452ae5a3e864d41":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5a9595a2de7247108a2ed76085d0e903":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e08bb36a3afa4b9090f025e31b030dca":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c393372b953d469ab58a75dac544c294":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b002676268f24266a851774f78dcfba3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f51c68345d6d423180e811068792a874","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3fbddda344b0401ca5fda83313d73691","IPY_MODEL_a9fd67528d40408696750d7deac0f140","IPY_MODEL_09b42e09702745d5a5b22ec231ac5aa1"]}},"f51c68345d6d423180e811068792a874":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3fbddda344b0401ca5fda83313d73691":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ecfd560f239e40d09e281f019700336b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"Export report to file: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_06d0b7a722e84deda09d333623c2b435"}},"a9fd67528d40408696750d7deac0f140":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0072063875634cc19e48aac84c1b4fc2","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_46cea95f59b04735a7e8cf7027c62476"}},"09b42e09702745d5a5b22ec231ac5aa1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d91801c00d254e09a3fe419514a06d99","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00,  1.79it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_77cf31cc641e42ddba59bc94933bed89"}},"ecfd560f239e40d09e281f019700336b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"06d0b7a722e84deda09d333623c2b435":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0072063875634cc19e48aac84c1b4fc2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"46cea95f59b04735a7e8cf7027c62476":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d91801c00d254e09a3fe419514a06d99":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"77cf31cc641e42ddba59bc94933bed89":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"8YZav-oup9E-","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1636051101547,"user_tz":-120,"elapsed":46413,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"a631b9f1-b00a-4de9-be72-fffff017d5fa"},"source":["from google.colab import drive\n","drive.mount('/content/drive')"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"odIDuuzQqNdH","executionInfo":{"status":"ok","timestamp":1636051159249,"user_tz":-120,"elapsed":288,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"f6dd2c7d-c7e6-4fab-ec84-a01630f53647"},"source":["cd '/content/drive/MyDrive/Customer_ Churn_Prediction/modify'"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/Customer_ Churn_Prediction/modify\n"]}]},{"cell_type":"code","metadata":{"id":"5WMFR29cqPET"},"source":["import pandas as pd\n","import numpy as np"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ZHfLvrqasVXU"},"source":[" !pip install pandas-profiling==2.7.1"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"kci4LuIRqRFn"},"source":["data = pd.read_csv('/content/drive/MyDrive/Customer_ Churn_Prediction/modify/train.csv')\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"IR5xM9x2qvEQ"},"source":["import pandas as pd\n","import pandas_profiling\n"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"5VpdDGMBATPW"},"source":["import category_encoders as ce\n","from sklearn.preprocessing import OneHotEncoder"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":145,"referenced_widgets":["c117f22fc4a74d2da8f69e4427ca991a","b88142ed89c642dca561363da6407560","40d1ea0dcc2d4e24ab5411345c96ae38","76d21ec86d49400697c2d0cd1459d008","b83ff9c008204e649ff415ffce720fee","197d00ef2be64a9faed0d5a3f538fdb4","5395459aa24f4838b88c31113ae55b60","58a78a250b8e49d48ffb766b4017d31b","821416ec241049be8edb1eac5cda6b58","406715bb620d4b2194509ebae05dcfdc","2b5dbff509104103ac711fc6a45d21ad","2238daf7f65d4863956a904a8972bb33","d6fd430977a9409fa484bb3b3396137a","90c1e106b28445a381eaa15d9560d1c3","a3cb496a5d7b4e9f8b96ae792af435c4","1fa06be1b18d45a99c43503e459bfffd","a41cb4c70df34c868ac89f3b99f38d33","1d9ea359d97d4336be271d7b3b92436b","7829b95388f24fab8ef58eb9f997bf28","7148fa349cc6404f85a8157e49a8a283","a97bac14e70842e2b70a7b8ebe70ab32","cd83874c7bda401c8002bbd277f9bc50","21146f330bd5453e97abd4876167e33f","5abb01e97268445b898b7e54e6d80a78","819a3b9994fc4590b8a03c67ec4a35b6","d50b197d173043b3b41533e400de710b","58a4f5194a8a4a6794f78c96f738885c","0b5e406f041d4522ad1954ae6999b295","736b1a078c7240ffa3119daae48ff73c","0b272075f35e46179452ae5a3e864d41","5a9595a2de7247108a2ed76085d0e903","e08bb36a3afa4b9090f025e31b030dca","c393372b953d469ab58a75dac544c294","b002676268f24266a851774f78dcfba3","f51c68345d6d423180e811068792a874","3fbddda344b0401ca5fda83313d73691","a9fd67528d40408696750d7deac0f140","09b42e09702745d5a5b22ec231ac5aa1","ecfd560f239e40d09e281f019700336b","06d0b7a722e84deda09d333623c2b435","0072063875634cc19e48aac84c1b4fc2","46cea95f59b04735a7e8cf7027c62476","d91801c00d254e09a3fe419514a06d99","77cf31cc641e42ddba59bc94933bed89"]},"id":"aMRyxOwarmE2","executionInfo":{"status":"ok","timestamp":1636051274277,"user_tz":-120,"elapsed":62279,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"86b5afb7-65eb-4926-d8a3-cb62598af085"},"source":["profile = data.profile_report(title='Pandas Profiling Report')\n","profile.to_file(output_file=\"churn_pandas_profiling.html\")"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"c117f22fc4a74d2da8f69e4427ca991a","version_minor":0,"version_major":2},"text/plain":["Summarize dataset:   0%|          | 0/32 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2238daf7f65d4863956a904a8972bb33","version_minor":0,"version_major":2},"text/plain":["Generate report structure:   0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"21146f330bd5453e97abd4876167e33f","version_minor":0,"version_major":2},"text/plain":["Render HTML:   0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b002676268f24266a851774f78dcfba3","version_minor":0,"version_major":2},"text/plain":["Export report to file:   0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":821,"output_embedded_package_id":"1pXemhGszQ-6HywjWueMys1cIYRyN8-ul"},"id":"WWu62bYzuo22","executionInfo":{"status":"ok","timestamp":1636051382859,"user_tz":-120,"elapsed":4415,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"3d55a87e-7a91-49c5-eed5-2aa7a270a206"},"source":["profile.to_notebook_iframe()"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":"Output hidden; open in https://colab.research.google.com to view."},"metadata":{}}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"RNJPBgv312DS","executionInfo":{"status":"ok","timestamp":1636051388539,"user_tz":-120,"elapsed":241,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"efe1dbaf-cf59-4550-8186-a30914b90697"},"source":["# extract the categorical variables\n","cat_var = [ feature for feature in data.columns if data[feature].dtypes=='O']\n","print('List of categorical variables {}'.format(cat_var))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["List of categorical variables ['state', 'area_code', 'international_plan', 'voice_mail_plan', 'churn']\n"]}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JTYs1d872bmv","executionInfo":{"status":"ok","timestamp":1636051391988,"user_tz":-120,"elapsed":273,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"a3f3d8c0-3f36-4b7a-8609-7a797f51cca1"},"source":["#Extract the numerical features from the dataset\n","num_var = [ feature for feature in data.columns if data[feature].dtypes!='O']\n","print('List of categorical variables {}'.format(num_var))"],"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["List of categorical variables ['account_length', 'number_vmail_messages', 'total_day_minutes', 'total_day_calls', 'total_day_charge', 'total_eve_minutes', 'total_eve_calls', 'total_eve_charge', 'total_night_minutes', 'total_night_calls', 'total_night_charge', 'total_intl_minutes', 'total_intl_calls', 'total_intl_charge', 'number_customer_service_calls']\n"]}]},{"cell_type":"code","metadata":{"id":"9OYpzM0RyhzW"},"source":["#every features has a outliers so we need to remove the outliers.\n","def remove_outliers(data,labels):\n","    for label in labels:\n","        q1 = data[label].quantile(0.25)\n","        q3 = data[label].quantile(0.75)\n","        iqr = q3 - q1\n","        upper_bound = q3 + 1.5 * iqr\n","        lower_bound = q1 - 1.5 * iqr\n","        data[label] = data[label].mask(data[label]< lower_bound, data[label].median(),axis=0)\n","        data[label] = data[label].mask(data[label]> upper_bound, data[label].median(),axis=0)\n","\n","    return data"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ZWzvLdqb3HyK"},"source":["data = remove_outliers(data, num_var)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"BM8p5BZ4KCKs"},"source":["#normalize data set convert to be between 0 and 1.\n","def min_max(data,labels):\n","    for column in labels:\n","        data[column] = (data[column] - data[column].min()) / (data[column].max() - data[column].min())\n","        \n","\n","    return data\n","    "],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"35cUG0U2O-0v"},"source":["data = min_max(data, num_var)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":223},"id":"5i1vPGJrQ6Hw","executionInfo":{"status":"ok","timestamp":1636051434413,"user_tz":-120,"elapsed":250,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"1d6b2df6-02ff-492e-9810-f45120d59a71"},"source":["data.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>state</th>\n","      <th>account_length</th>\n","      <th>area_code</th>\n","      <th>international_plan</th>\n","      <th>voice_mail_plan</th>\n","      <th>number_vmail_messages</th>\n","      <th>total_day_minutes</th>\n","      <th>total_day_calls</th>\n","      <th>total_day_charge</th>\n","      <th>total_eve_minutes</th>\n","      <th>total_eve_calls</th>\n","      <th>total_eve_charge</th>\n","      <th>total_night_minutes</th>\n","      <th>total_night_calls</th>\n","      <th>total_night_charge</th>\n","      <th>total_intl_minutes</th>\n","      <th>total_intl_calls</th>\n","      <th>total_intl_charge</th>\n","      <th>number_customer_service_calls</th>\n","      <th>churn</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>OH</td>\n","      <td>0.512077</td>\n","      <td>area_code_415</td>\n","      <td>no</td>\n","      <td>yes</td>\n","      <td>0.65</td>\n","      <td>0.436770</td>\n","      <td>0.721154</td>\n","      <td>0.436805</td>\n","      <td>0.484669</td>\n","      <td>0.523364</td>\n","      <td>0.484572</td>\n","      <td>0.702408</td>\n","      <td>0.532710</td>\n","      <td>0.702341</td>\n","      <td>0.748201</td>\n","      <td>0.3</td>\n","      <td>0.749333</td>\n","      <td>0.333333</td>\n","      <td>no</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>NJ</td>\n","      <td>0.657005</td>\n","      <td>area_code_415</td>\n","      <td>no</td>\n","      <td>no</td>\n","      <td>0.00</td>\n","      <td>0.717869</td>\n","      <td>0.634615</td>\n","      <td>0.718099</td>\n","      <td>0.210196</td>\n","      <td>0.588785</td>\n","      <td>0.209909</td>\n","      <td>0.357035</td>\n","      <td>0.542056</td>\n","      <td>0.357023</td>\n","      <td>0.640288</td>\n","      <td>0.5</td>\n","      <td>0.640000</td>\n","      <td>0.000000</td>\n","      <td>no</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>OH</td>\n","      <td>0.400966</td>\n","      <td>area_code_408</td>\n","      <td>yes</td>\n","      <td>no</td>\n","      <td>0.00</td>\n","      <td>0.910309</td>\n","      <td>0.221154</td>\n","      <td>0.910617</td>\n","      <td>0.503879</td>\n","      <td>0.383178</td>\n","      <td>0.503694</td>\n","      <td>0.486080</td>\n","      <td>0.401869</td>\n","      <td>0.485786</td>\n","      <td>0.237410</td>\n","      <td>0.7</td>\n","      <td>0.237333</td>\n","      <td>0.666667</td>\n","      <td>no</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>OK</td>\n","      <td>0.357488</td>\n","      <td>area_code_415</td>\n","      <td>yes</td>\n","      <td>no</td>\n","      <td>0.00</td>\n","      <td>0.454296</td>\n","      <td>0.625000</td>\n","      <td>0.454398</td>\n","      <td>0.310307</td>\n","      <td>0.700935</td>\n","      <td>0.310300</td>\n","      <td>0.448457</td>\n","      <td>0.700935</td>\n","      <td>0.448161</td>\n","      <td>0.489209</td>\n","      <td>0.3</td>\n","      <td>0.490667</td>\n","      <td>1.000000</td>\n","      <td>no</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>MA</td>\n","      <td>0.579710</td>\n","      <td>area_code_510</td>\n","      <td>no</td>\n","      <td>yes</td>\n","      <td>0.60</td>\n","      <td>0.631271</td>\n","      <td>0.384615</td>\n","      <td>0.631345</td>\n","      <td>0.503879</td>\n","      <td>0.570093</td>\n","      <td>0.503694</td>\n","      <td>0.545147</td>\n","      <td>0.672897</td>\n","      <td>0.545151</td>\n","      <td>0.302158</td>\n","      <td>0.7</td>\n","      <td>0.304000</td>\n","      <td>1.000000</td>\n","      <td>no</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["  state  account_length  ... number_customer_service_calls churn\n","0    OH        0.512077  ...                      0.333333    no\n","1    NJ        0.657005  ...                      0.000000    no\n","2    OH        0.400966  ...                      0.666667    no\n","3    OK        0.357488  ...                      1.000000    no\n","4    MA        0.579710  ...                      1.000000    no\n","\n","[5 rows x 20 columns]"]},"metadata":{},"execution_count":17}]},{"cell_type":"code","metadata":{"id":"Bh-xBhHo_mBr","colab":{"base_uri":"https://localhost:8080/","height":223},"executionInfo":{"status":"ok","timestamp":1636051676242,"user_tz":-120,"elapsed":288,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"571a8d83-0091-42d2-f69f-374d8f1b413a"},"source":["#convert catogorical value to numerical \n","data.international_plan.replace(['no','yes'],[0,1],inplace = True)\n","data.voice_mail_plan.replace(['no','yes'],[0,1],inplace=True)\n","data.churn.replace(['no','yes'],[0,1],inplace = True)\n","data.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>state</th>\n","      <th>account_length</th>\n","      <th>area_code</th>\n","      <th>international_plan</th>\n","      <th>voice_mail_plan</th>\n","      <th>number_vmail_messages</th>\n","      <th>total_day_minutes</th>\n","      <th>total_day_calls</th>\n","      <th>total_day_charge</th>\n","      <th>total_eve_minutes</th>\n","      <th>total_eve_calls</th>\n","      <th>total_eve_charge</th>\n","      <th>total_night_minutes</th>\n","      <th>total_night_calls</th>\n","      <th>total_night_charge</th>\n","      <th>total_intl_minutes</th>\n","      <th>total_intl_calls</th>\n","      <th>total_intl_charge</th>\n","      <th>number_customer_service_calls</th>\n","      <th>churn</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>OH</td>\n","      <td>0.512077</td>\n","      <td>area_code_415</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.65</td>\n","      <td>0.436770</td>\n","      <td>0.721154</td>\n","      <td>0.436805</td>\n","      <td>0.484669</td>\n","      <td>0.523364</td>\n","      <td>0.484572</td>\n","      <td>0.702408</td>\n","      <td>0.532710</td>\n","      <td>0.702341</td>\n","      <td>0.748201</td>\n","      <td>0.3</td>\n","      <td>0.749333</td>\n","      <td>0.333333</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>NJ</td>\n","      <td>0.657005</td>\n","      <td>area_code_415</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.717869</td>\n","      <td>0.634615</td>\n","      <td>0.718099</td>\n","      <td>0.210196</td>\n","      <td>0.588785</td>\n","      <td>0.209909</td>\n","      <td>0.357035</td>\n","      <td>0.542056</td>\n","      <td>0.357023</td>\n","      <td>0.640288</td>\n","      <td>0.5</td>\n","      <td>0.640000</td>\n","      <td>0.000000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>OH</td>\n","      <td>0.400966</td>\n","      <td>area_code_408</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.910309</td>\n","      <td>0.221154</td>\n","      <td>0.910617</td>\n","      <td>0.503879</td>\n","      <td>0.383178</td>\n","      <td>0.503694</td>\n","      <td>0.486080</td>\n","      <td>0.401869</td>\n","      <td>0.485786</td>\n","      <td>0.237410</td>\n","      <td>0.7</td>\n","      <td>0.237333</td>\n","      <td>0.666667</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>OK</td>\n","      <td>0.357488</td>\n","      <td>area_code_415</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.454296</td>\n","      <td>0.625000</td>\n","      <td>0.454398</td>\n","      <td>0.310307</td>\n","      <td>0.700935</td>\n","      <td>0.310300</td>\n","      <td>0.448457</td>\n","      <td>0.700935</td>\n","      <td>0.448161</td>\n","      <td>0.489209</td>\n","      <td>0.3</td>\n","      <td>0.490667</td>\n","      <td>1.000000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>MA</td>\n","      <td>0.579710</td>\n","      <td>area_code_510</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.60</td>\n","      <td>0.631271</td>\n","      <td>0.384615</td>\n","      <td>0.631345</td>\n","      <td>0.503879</td>\n","      <td>0.570093</td>\n","      <td>0.503694</td>\n","      <td>0.545147</td>\n","      <td>0.672897</td>\n","      <td>0.545151</td>\n","      <td>0.302158</td>\n","      <td>0.7</td>\n","      <td>0.304000</td>\n","      <td>1.000000</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["  state  account_length  ... number_customer_service_calls  churn\n","0    OH        0.512077  ...                      0.333333      0\n","1    NJ        0.657005  ...                      0.000000      0\n","2    OH        0.400966  ...                      0.666667      0\n","3    OK        0.357488  ...                      1.000000      0\n","4    MA        0.579710  ...                      1.000000      0\n","\n","[5 rows x 20 columns]"]},"metadata":{},"execution_count":18}]},{"cell_type":"code","metadata":{"id":"Xj6Y6Y4W_rij"},"source":["!pip install category_encoders"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"IOH4WPra_Wdo"},"source":["import category_encoders as ce\n","from category_encoders.hashing import HashingEncoder"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"F0nNO0Ej_39W"},"source":["#Handling the state feature\n","hash_state = ce.HashingEncoder(cols = 'state')\n","data = hash_state.fit_transform(data)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":223},"id":"lKWtGdyaACSA","executionInfo":{"status":"ok","timestamp":1636051749787,"user_tz":-120,"elapsed":296,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"1aa2c603-9e4e-4d1f-c06c-57902b6bafcf"},"source":["data.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>col_0</th>\n","      <th>col_1</th>\n","      <th>col_2</th>\n","      <th>col_3</th>\n","      <th>col_4</th>\n","      <th>col_5</th>\n","      <th>col_6</th>\n","      <th>col_7</th>\n","      <th>account_length</th>\n","      <th>area_code</th>\n","      <th>international_plan</th>\n","      <th>voice_mail_plan</th>\n","      <th>number_vmail_messages</th>\n","      <th>total_day_minutes</th>\n","      <th>total_day_calls</th>\n","      <th>total_day_charge</th>\n","      <th>total_eve_minutes</th>\n","      <th>total_eve_calls</th>\n","      <th>total_eve_charge</th>\n","      <th>total_night_minutes</th>\n","      <th>total_night_calls</th>\n","      <th>total_night_charge</th>\n","      <th>total_intl_minutes</th>\n","      <th>total_intl_calls</th>\n","      <th>total_intl_charge</th>\n","      <th>number_customer_service_calls</th>\n","      <th>churn</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.512077</td>\n","      <td>area_code_415</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.65</td>\n","      <td>0.436770</td>\n","      <td>0.721154</td>\n","      <td>0.436805</td>\n","      <td>0.484669</td>\n","      <td>0.523364</td>\n","      <td>0.484572</td>\n","      <td>0.702408</td>\n","      <td>0.532710</td>\n","      <td>0.702341</td>\n","      <td>0.748201</td>\n","      <td>0.3</td>\n","      <td>0.749333</td>\n","      <td>0.333333</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.657005</td>\n","      <td>area_code_415</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.717869</td>\n","      <td>0.634615</td>\n","      <td>0.718099</td>\n","      <td>0.210196</td>\n","      <td>0.588785</td>\n","      <td>0.209909</td>\n","      <td>0.357035</td>\n","      <td>0.542056</td>\n","      <td>0.357023</td>\n","      <td>0.640288</td>\n","      <td>0.5</td>\n","      <td>0.640000</td>\n","      <td>0.000000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.400966</td>\n","      <td>area_code_408</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.910309</td>\n","      <td>0.221154</td>\n","      <td>0.910617</td>\n","      <td>0.503879</td>\n","      <td>0.383178</td>\n","      <td>0.503694</td>\n","      <td>0.486080</td>\n","      <td>0.401869</td>\n","      <td>0.485786</td>\n","      <td>0.237410</td>\n","      <td>0.7</td>\n","      <td>0.237333</td>\n","      <td>0.666667</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.357488</td>\n","      <td>area_code_415</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.454296</td>\n","      <td>0.625000</td>\n","      <td>0.454398</td>\n","      <td>0.310307</td>\n","      <td>0.700935</td>\n","      <td>0.310300</td>\n","      <td>0.448457</td>\n","      <td>0.700935</td>\n","      <td>0.448161</td>\n","      <td>0.489209</td>\n","      <td>0.3</td>\n","      <td>0.490667</td>\n","      <td>1.000000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.579710</td>\n","      <td>area_code_510</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.60</td>\n","      <td>0.631271</td>\n","      <td>0.384615</td>\n","      <td>0.631345</td>\n","      <td>0.503879</td>\n","      <td>0.570093</td>\n","      <td>0.503694</td>\n","      <td>0.545147</td>\n","      <td>0.672897</td>\n","      <td>0.545151</td>\n","      <td>0.302158</td>\n","      <td>0.7</td>\n","      <td>0.304000</td>\n","      <td>1.000000</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   col_0  col_1  col_2  ...  total_intl_charge  number_customer_service_calls  churn\n","0      0      0      0  ...           0.749333                       0.333333      0\n","1      0      1      0  ...           0.640000                       0.000000      0\n","2      0      0      0  ...           0.237333                       0.666667      0\n","3      0      0      0  ...           0.490667                       1.000000      0\n","4      0      0      0  ...           0.304000                       1.000000      0\n","\n","[5 rows x 27 columns]"]},"metadata":{},"execution_count":22}]},{"cell_type":"code","metadata":{"id":"_3qRjQrgTl3w"},"source":["from sklearn.preprocessing import OneHotEncoder"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"ComBI4qJAMPF"},"source":["# converting the area_code to numerical variable using one-hot encoder\n","onehot_area = OneHotEncoder()\n","onehot_area.fit(data[['area_code']])\n","\n","encoded_values = onehot_area.transform(data[['area_code']])\n","data[onehot_area.categories_[0]] = encoded_values.toarray()\n","data = data.drop('area_code', axis=1)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":223},"id":"e6Snds-EAglW","executionInfo":{"status":"ok","timestamp":1636052273445,"user_tz":-120,"elapsed":279,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"f0c798c7-beee-453d-893c-09d0164b6c8f"},"source":["data.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>col_0</th>\n","      <th>col_1</th>\n","      <th>col_2</th>\n","      <th>col_3</th>\n","      <th>col_4</th>\n","      <th>col_5</th>\n","      <th>col_6</th>\n","      <th>col_7</th>\n","      <th>account_length</th>\n","      <th>international_plan</th>\n","      <th>voice_mail_plan</th>\n","      <th>number_vmail_messages</th>\n","      <th>total_day_minutes</th>\n","      <th>total_day_calls</th>\n","      <th>total_day_charge</th>\n","      <th>total_eve_minutes</th>\n","      <th>total_eve_calls</th>\n","      <th>total_eve_charge</th>\n","      <th>total_night_minutes</th>\n","      <th>total_night_calls</th>\n","      <th>total_night_charge</th>\n","      <th>total_intl_minutes</th>\n","      <th>total_intl_calls</th>\n","      <th>total_intl_charge</th>\n","      <th>number_customer_service_calls</th>\n","      <th>churn</th>\n","      <th>area_code_408</th>\n","      <th>area_code_415</th>\n","      <th>area_code_510</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.512077</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.65</td>\n","      <td>0.436770</td>\n","      <td>0.721154</td>\n","      <td>0.436805</td>\n","      <td>0.484669</td>\n","      <td>0.523364</td>\n","      <td>0.484572</td>\n","      <td>0.702408</td>\n","      <td>0.532710</td>\n","      <td>0.702341</td>\n","      <td>0.748201</td>\n","      <td>0.3</td>\n","      <td>0.749333</td>\n","      <td>0.333333</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.657005</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.717869</td>\n","      <td>0.634615</td>\n","      <td>0.718099</td>\n","      <td>0.210196</td>\n","      <td>0.588785</td>\n","      <td>0.209909</td>\n","      <td>0.357035</td>\n","      <td>0.542056</td>\n","      <td>0.357023</td>\n","      <td>0.640288</td>\n","      <td>0.5</td>\n","      <td>0.640000</td>\n","      <td>0.000000</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.400966</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.910309</td>\n","      <td>0.221154</td>\n","      <td>0.910617</td>\n","      <td>0.503879</td>\n","      <td>0.383178</td>\n","      <td>0.503694</td>\n","      <td>0.486080</td>\n","      <td>0.401869</td>\n","      <td>0.485786</td>\n","      <td>0.237410</td>\n","      <td>0.7</td>\n","      <td>0.237333</td>\n","      <td>0.666667</td>\n","      <td>0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.357488</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.454296</td>\n","      <td>0.625000</td>\n","      <td>0.454398</td>\n","      <td>0.310307</td>\n","      <td>0.700935</td>\n","      <td>0.310300</td>\n","      <td>0.448457</td>\n","      <td>0.700935</td>\n","      <td>0.448161</td>\n","      <td>0.489209</td>\n","      <td>0.3</td>\n","      <td>0.490667</td>\n","      <td>1.000000</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.579710</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.60</td>\n","      <td>0.631271</td>\n","      <td>0.384615</td>\n","      <td>0.631345</td>\n","      <td>0.503879</td>\n","      <td>0.570093</td>\n","      <td>0.503694</td>\n","      <td>0.545147</td>\n","      <td>0.672897</td>\n","      <td>0.545151</td>\n","      <td>0.302158</td>\n","      <td>0.7</td>\n","      <td>0.304000</td>\n","      <td>1.000000</td>\n","      <td>0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   col_0  col_1  col_2  ...  area_code_408  area_code_415  area_code_510\n","0      0      0      0  ...            0.0            1.0            0.0\n","1      0      1      0  ...            0.0            1.0            0.0\n","2      0      0      0  ...            1.0            0.0            0.0\n","3      0      0      0  ...            0.0            1.0            0.0\n","4      0      0      0  ...            0.0            0.0            1.0\n","\n","[5 rows x 29 columns]"]},"metadata":{},"execution_count":26}]},{"cell_type":"code","metadata":{"id":"9JdUXc8BAo2P"},"source":["labels =data.filter(['churn'],axis=1)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":203},"id":"IQ4NIqOvA3wq","executionInfo":{"status":"ok","timestamp":1636052934147,"user_tz":-120,"elapsed":298,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"1269f028-9cbb-49f7-cfd5-80c0eae6c4cf"},"source":["labels.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>churn</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   churn\n","0      0\n","1      0\n","2      0\n","3      0\n","4      0"]},"metadata":{},"execution_count":28}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":223},"id":"JL8XhBTlA6R2","executionInfo":{"status":"ok","timestamp":1636052937309,"user_tz":-120,"elapsed":301,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"93f72044-61d3-4a5e-c95e-47e8474c982b"},"source":["features = data.drop('churn', 1)\n","features.head()"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>col_0</th>\n","      <th>col_1</th>\n","      <th>col_2</th>\n","      <th>col_3</th>\n","      <th>col_4</th>\n","      <th>col_5</th>\n","      <th>col_6</th>\n","      <th>col_7</th>\n","      <th>account_length</th>\n","      <th>international_plan</th>\n","      <th>voice_mail_plan</th>\n","      <th>number_vmail_messages</th>\n","      <th>total_day_minutes</th>\n","      <th>total_day_calls</th>\n","      <th>total_day_charge</th>\n","      <th>total_eve_minutes</th>\n","      <th>total_eve_calls</th>\n","      <th>total_eve_charge</th>\n","      <th>total_night_minutes</th>\n","      <th>total_night_calls</th>\n","      <th>total_night_charge</th>\n","      <th>total_intl_minutes</th>\n","      <th>total_intl_calls</th>\n","      <th>total_intl_charge</th>\n","      <th>number_customer_service_calls</th>\n","      <th>area_code_408</th>\n","      <th>area_code_415</th>\n","      <th>area_code_510</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.512077</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.65</td>\n","      <td>0.436770</td>\n","      <td>0.721154</td>\n","      <td>0.436805</td>\n","      <td>0.484669</td>\n","      <td>0.523364</td>\n","      <td>0.484572</td>\n","      <td>0.702408</td>\n","      <td>0.532710</td>\n","      <td>0.702341</td>\n","      <td>0.748201</td>\n","      <td>0.3</td>\n","      <td>0.749333</td>\n","      <td>0.333333</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.657005</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.717869</td>\n","      <td>0.634615</td>\n","      <td>0.718099</td>\n","      <td>0.210196</td>\n","      <td>0.588785</td>\n","      <td>0.209909</td>\n","      <td>0.357035</td>\n","      <td>0.542056</td>\n","      <td>0.357023</td>\n","      <td>0.640288</td>\n","      <td>0.5</td>\n","      <td>0.640000</td>\n","      <td>0.000000</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.400966</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.910309</td>\n","      <td>0.221154</td>\n","      <td>0.910617</td>\n","      <td>0.503879</td>\n","      <td>0.383178</td>\n","      <td>0.503694</td>\n","      <td>0.486080</td>\n","      <td>0.401869</td>\n","      <td>0.485786</td>\n","      <td>0.237410</td>\n","      <td>0.7</td>\n","      <td>0.237333</td>\n","      <td>0.666667</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.357488</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0.00</td>\n","      <td>0.454296</td>\n","      <td>0.625000</td>\n","      <td>0.454398</td>\n","      <td>0.310307</td>\n","      <td>0.700935</td>\n","      <td>0.310300</td>\n","      <td>0.448457</td>\n","      <td>0.700935</td>\n","      <td>0.448161</td>\n","      <td>0.489209</td>\n","      <td>0.3</td>\n","      <td>0.490667</td>\n","      <td>1.000000</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0</td>\n","      <td>0.579710</td>\n","      <td>0</td>\n","      <td>1</td>\n","      <td>0.60</td>\n","      <td>0.631271</td>\n","      <td>0.384615</td>\n","      <td>0.631345</td>\n","      <td>0.503879</td>\n","      <td>0.570093</td>\n","      <td>0.503694</td>\n","      <td>0.545147</td>\n","      <td>0.672897</td>\n","      <td>0.545151</td>\n","      <td>0.302158</td>\n","      <td>0.7</td>\n","      <td>0.304000</td>\n","      <td>1.000000</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>1.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["   col_0  col_1  col_2  ...  area_code_408  area_code_415  area_code_510\n","0      0      0      0  ...            0.0            1.0            0.0\n","1      0      1      0  ...            0.0            1.0            0.0\n","2      0      0      0  ...            1.0            0.0            0.0\n","3      0      0      0  ...            0.0            1.0            0.0\n","4      0      0      0  ...            0.0            0.0            1.0\n","\n","[5 rows x 28 columns]"]},"metadata":{},"execution_count":29}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"49srAkgMH9il","executionInfo":{"status":"ok","timestamp":1636049090211,"user_tz":-120,"elapsed":331,"user":{"displayName":"basant elsayed","photoUrl":"https://lh3.googleusercontent.com/a/default-user=s64","userId":"17445912074822560283"}},"outputId":"8886909f-08ee-4807-b4eb-9f6bc9e8e2f7"},"source":["features.shape"],"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(4250, 28)"]},"metadata":{},"execution_count":69}]},{"cell_type":"code","metadata":{"id":"0QGgBedlY-U5"},"source":["#save data \n","features.to_csv(\"features.csv\",index=False)\n","labels.to_csv(\"labels.csv\",index=False)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"_jAagbdAXyz4"},"source":["## Conclusion\n"," **Exploratory Data Analysis**\n","\n","EDA helps us to understand the data set and its relations with each other \n","By making EDA at this data I find out that \n","\n","**By looking at the data**\n","1-9.3% of clint will churn \n","\n","2_49.6% of customers are living in the area code area_code_415.\n","\n","3_most of the client didn't have an international plan\n","\n","4_73.8% of clients has no voice plan \n","\n","5-14.1%  churn \n","\n","6-number_customer_service_calls,total_intl_calls,number_vmail_messages have no normal distribution and will convert it to normal \n","\n","After exploring the data to find the highest period of time the churn happens \n","\n","**for numerical data**\n","\n","I found out that \n","the account length is between 90 to 130 has a high value of churn \n","\n","1-More churn rate when the number_vamil_messages is 0\n","\n","2-More churn rate when the total day minutes between 210 to 300 \n","\n","3-ore churn rate when the total day calls is 85 to 120\n","\n","4-More churn rate when the total day charge between  45 to 50\n","\n","5-More churn rate when the total day charge between  160 to 200\n","\n","6-More churn rate when the total_eve_call between  60 to 120\n","\n","7-More churn rate when the total_eve_charge between  15 to 18\n","\n","8-Churn rate is high when the total_night_minutes is lies between 190 to 200 min\n","\n","9-Churn rate is high when the total_night_calls is lies between 90 to 115\n","\n","10-churn rate is high when total_night_charge lies between 7.5 to 10.\n","\n","11-churn rate is high when total_int_min lies between 7 to 12.\n","\n","12-churn rate is high when total_int_claas are,4,5\n","\n","13-churn rate is high when the total international charge is 2.5 to 3.\n","\n","14-churn rate is high when the number of customer service calls is 1.\n","\n","After exploring the data we need to handle it to five to the model \n","By converting categorical data to numerical and normalized categorical data and remove outliers \n"," \n","**Categorical data**\n","\n","converting the area_code to a numerical variable using a one-hot encoder\n","Convert yes, no to 1,0\n","Handling the state feature using HashingEncoder\n","\n"," **After handeling the data**\n"," \n"," save features and labels data to csv files \n"," \n"]}]}